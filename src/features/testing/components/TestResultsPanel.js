import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useTranslation } from 'react-i18next';
import { useTestResults } from '../hooks/useTestResults';
import { TestCaseItem } from './TestCaseItem';
import { FmCommonStatCard } from '@/components/common/display/FmCommonStatCard';
import { Button } from '@/components/common/shadcn/button';
import { Input } from '@/components/common/shadcn/input';
import { Badge } from '@/components/common/shadcn/badge';
import { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger, } from '@/components/common/shadcn/dropdown-menu';
import { Download, Search, CheckCircle2, XCircle, AlertCircle, FileJson, FileText, } from 'lucide-react';
export function TestResultsPanel({ results }) {
    const { t } = useTranslation('common');
    const { filteredResults, summary, filter, setFilter, searchTerm, setSearchTerm, exportResults, } = useTestResults(results);
    if (results.length === 0) {
        return (_jsx("div", { className: 'text-center py-12', children: _jsx("p", { className: 'text-muted-foreground', children: t('testResultsPanel.noResultsYet') }) }));
    }
    return (_jsxs("div", { className: 'space-y-6', children: [_jsxs("div", { className: 'grid grid-cols-1 md:grid-cols-4 gap-4', children: [_jsx(FmCommonStatCard, { value: summary.total, label: t('testResultsPanel.totalTests'), size: 'sm' }), _jsx(FmCommonStatCard, { value: summary.passed, label: t('testResultsPanel.passed'), icon: CheckCircle2, size: 'sm', className: 'border-green-500/30 bg-green-500/5' }), _jsx(FmCommonStatCard, { value: summary.failed, label: t('testResultsPanel.failed'), icon: XCircle, size: 'sm', className: 'border-red-500/30 bg-red-500/5' }), _jsx(FmCommonStatCard, { value: `${summary.successRate.toFixed(1)}%`, label: t('testResultsPanel.successRate'), size: 'sm' })] }), _jsxs("div", { className: 'grid grid-cols-1 md:grid-cols-2 gap-4', children: [_jsx(FmCommonStatCard, { value: `${summary.averageExecutionTime.toFixed(0)}ms`, label: t('testResultsPanel.avgExecutionTime'), size: 'sm' }), _jsx(FmCommonStatCard, { value: `${(summary.totalExecutionTime / 1000).toFixed(2)}s`, label: t('testResultsPanel.totalTime'), size: 'sm' })] }), _jsxs("div", { className: 'flex flex-col sm:flex-row gap-4', children: [_jsxs("div", { className: 'relative flex-1', children: [_jsx(Search, { className: 'absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground' }), _jsx(Input, { placeholder: t('testResultsPanel.searchTests'), value: searchTerm, onChange: e => setSearchTerm(e.target.value), className: 'pl-10' })] }), _jsxs("div", { className: 'flex gap-2', children: [_jsxs(Button, { variant: filter === 'all' ? 'default' : 'outline', size: 'sm', onClick: () => setFilter('all'), children: [t('testResultsPanel.all'), _jsx(Badge, { variant: 'secondary', className: 'ml-2', children: results.length })] }), _jsxs(Button, { variant: filter === 'passed' ? 'default' : 'outline', size: 'sm', onClick: () => setFilter('passed'), children: [t('testResultsPanel.passed'), _jsx(Badge, { variant: 'secondary', className: 'ml-2', children: summary.passed })] }), _jsxs(Button, { variant: filter === 'failed' ? 'default' : 'outline', size: 'sm', onClick: () => setFilter('failed'), children: [t('testResultsPanel.failed'), _jsx(Badge, { variant: 'secondary', className: 'ml-2', children: summary.failed })] })] }), _jsxs(DropdownMenu, { children: [_jsx(DropdownMenuTrigger, { asChild: true, children: _jsxs(Button, { variant: 'outline', size: 'sm', children: [_jsx(Download, { className: 'h-4 w-4 mr-2' }), t('testResultsPanel.export')] }) }), _jsxs(DropdownMenuContent, { align: 'end', children: [_jsxs(DropdownMenuItem, { onClick: () => exportResults('json'), children: [_jsx(FileJson, { className: 'h-4 w-4 mr-2' }), t('testResultsPanel.exportAsJson')] }), _jsxs(DropdownMenuItem, { onClick: () => exportResults('csv'), children: [_jsx(FileText, { className: 'h-4 w-4 mr-2' }), t('testResultsPanel.exportAsCsv')] })] })] })] }), _jsx("div", { className: 'space-y-3', children: filteredResults.length === 0 ? (_jsxs("div", { className: 'text-center py-8', children: [_jsx(AlertCircle, { className: 'h-8 w-8 mx-auto text-muted-foreground mb-2' }), _jsx("p", { className: 'text-muted-foreground', children: t('testResultsPanel.noMatchingTests') })] })) : (filteredResults.map(result => (_jsx(TestCaseItem, { result: result }, result.testId)))) })] }));
}
